<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pro Trading Journal v2</title>
    
    <!-- LIBRARIES -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>

    <!-- FIREBASE & LOGIC -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, addDoc, doc, updateDoc, deleteDoc, onSnapshot, query, orderBy, setDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        // --- CONFIG ---
        const firebaseConfig = {
            apiKey: "AIzaSyDMEkiy3VjmLwCvIiTJRicXI9jxmkDELrk",
            authDomain: "my-trading-journal-deffe.firebaseapp.com",
            projectId: "my-trading-journal-deffe",
            storageBucket: "my-trading-journal-deffe.firebasestorage.app",
            messagingSenderId: "264398734800",
            appId: "1:264398734800:web:74c6c6c5aef692424825d5"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const FINNHUB_KEY = "d5om819r01qjast7ji4gd5om819r01qjast7ji50";

        // --- STATE ---
        let trades = [];
        let settings = { startBalance: 100000, adjustments: 0 }; 
        let winLossChart;

        // --- LISTENERS ---
        const q = query(collection(db, "trades"), orderBy("date", "desc"));
        onSnapshot(q, (snap) => {
            trades = snap.docs.map(d => ({ id: d.id, ...d.data() }));
            updateDashboard();
        });

        onSnapshot(doc(db, "settings", "config"), (doc) => {
            if (doc.exists()) {
                settings = { ...settings, ...doc.data() };
                updateDashboard();
            }
        });

        // --- CORE FUNCTIONS ---

        // 1. SAVE TRADE (Entry)
        window.saveTrade = async () => {
            const file = document.getElementById('tImage').files[0];
            let base64 = null;
            if(file) base64 = await toBase64(file);

            const id = document.getElementById('editTradeId').value;
            const dir = document.getElementById('tDirection').value;
            
            const tradeData = {
                symbol: document.getElementById('tSymbol').value.toUpperCase(),
                direction: dir, // 'Long' or 'Short'
                entryPrice: parseFloat(document.getElementById('tEntry').value),
                qty: parseFloat(document.getElementById('tQty').value),
                stopLoss: parseFloat(document.getElementById('tStop').value),
                notes: document.getElementById('tNotes').value,
                date: id ? trades.find(t=>t.id===id).date : new Date().toISOString(),
                status: id ? trades.find(t=>t.id===id).status : 'Open',
                livePrice: parseFloat(document.getElementById('tEntry').value),
                avgExitPrice: id ? trades.find(t=>t.id===id).avgExitPrice : 0,
                exitDate: id ? trades.find(t=>t.id===id).exitDate : null,
                entryImage: base64 || (id ? trades.find(t=>t.id===id).entryImage : null),
                exitImage: id ? trades.find(t=>t.id===id).exitImage : null
            };

            if(id) await updateDoc(doc(db, "trades", id), tradeData);
            else await addDoc(collection(db, "trades"), tradeData);
            
            toggleModal('tradeModal');
        };

        // 2. CLOSE / MANAGE POSITION
        window.executeClose = async (isFull) => {
            const id = document.getElementById('manageId').value;
            const price = parseFloat(document.getElementById('exitPrice').value);
            const qty = parseFloat(document.getElementById('exitQty').value);
            const file = document.getElementById('exitImageFile').files[0];
            
            let exitImg = null;
            if(file) exitImg = await toBase64(file);

            const t = trades.find(x => x.id === id);
            const updateData = {};

            if(isFull || qty >= t.qty) {
                updateData.status = 'Closed';
                updateData.avgExitPrice = price;
                updateData.exitDate = new Date().toISOString();
                if(exitImg) updateData.exitImage = exitImg;
            } else {
                updateData.qty = t.qty - qty; // Partial trim
            }

            await updateDoc(doc(db, "trades", id), updateData);
            toggleModal('partialModal');
        };

        // 3. SETTINGS (Deposits/Withdrawals)
        window.saveSettings = async () => {
            const start = parseFloat(document.getElementById('setStart').value);
            const dep = parseFloat(document.getElementById('setDeposit').value) || 0;
            const withdr = parseFloat(document.getElementById('setWithdraw').value) || 0;
            
            // Calculate new adjustments total
            const currentAdj = settings.adjustments || 0;
            const newAdj = currentAdj + dep - withdr;

            await setDoc(doc(db, "settings", "config"), { 
                startBalance: start,
                adjustments: newAdj
            });
            
            // Clear inputs
            document.getElementById('setDeposit').value = '';
            document.getElementById('setWithdraw').value = '';
            toggleModal('settingsModal');
        };

        // 4. LIVE PRICES
        window.refreshPrices = async () => {
            const btn = document.getElementById('refreshBtn');
            btn.innerHTML = "Updating...";
            for(let t of trades) {
                if(t.status === 'Open') {
                    try {
                        const res = await fetch(`https://finnhub.io/api/v1/quote?symbol=${t.symbol}&token=${FINNHUB_KEY}`);
                        const data = await res.json();
                        if(data.c) await updateDoc(doc(db, "trades", t.id), { livePrice: data.c });
                    } catch(e) { console.error(e); }
                }
            }
            btn.innerHTML = 'Live Prices';
        };

        // 5. PDF EXPORT
        window.exportPDF = () => {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF('l', 'mm', 'a4'); // Landscape
            doc.text("Trading Journal Export", 14, 15);
            
            const data = trades.map(t => [
                t.date.substring(0,10),
                t.symbol,
                t.direction,
                t.entryPrice,
                t.status === 'Closed' ? t.avgExitPrice : t.livePrice,
                t.qty,
                calculatePL(t).pl.toFixed(2)
            ]);

            doc.autoTable({
                head: [['Date', 'Ticker', 'Dir', 'Entry', 'Exit/Last', 'Qty', 'P/L']],
                body: data,
                startY: 20
            });
            doc.save("journal.pdf");
        };

        // --- HELPERS ---
        const toBase64 = file => new Promise((resolve, reject) => {
            const reader = new FileReader();
            reader.readAsDataURL(file);
            reader.onload = () => resolve(reader.result);
            reader.onerror = error => reject(error);
        });

        function calculatePL(t) {
            const isLong = t.direction !== 'Short';
            const cur = t.status === 'Closed' ? t.avgExitPrice : (t.livePrice || t.entryPrice);
            
            // P/L Logic
            let pl = isLong ? (cur - t.entryPrice) * t.qty : (t.entryPrice - cur) * t.qty;
            let plPct = isLong 
                ? ((cur - t.entryPrice) / t.entryPrice) * 100 
                : ((t.entryPrice - cur) / t.entryPrice) * 100;

            // Risk Logic
            const riskPerShare = Math.abs(t.entryPrice - t.stopLoss);
            const totalRisk = riskPerShare * t.qty;
            
            // Heat Logic (Current Risk)
            // Long Heat: (Stop - Current) -> If Price < Stop, Heat is realized loss. 
            // If Price > Stop, Heat is (Entry - Stop)? No, User wants (Price - Stop)
            // If Short: (Current - Stop)
            let heat = 0;
            if (t.status === 'Open') {
                if(isLong) heat = (t.entryPrice - t.stopLoss) * t.qty; // Initial Risk sitting on table
                // User asked for "Price - Stop Loss". 
                // For Long: If Price 100, Stop 90. Heat 10.
                // For Short: If Price 100, Stop 110. Heat -10? 
                // Let's stick to "Risk Amount":
                // Real Open Risk is: |Current - Stop| * Qty
                heat = Math.abs(cur - t.stopLoss) * t.qty;
            }

            // R/R = Profit / Risk
            let rr = totalRisk > 0 ? (pl / totalRisk).toFixed(2) : 0;

            return { pl, plPct, heat, rr, totalRisk };
        }

        // --- DASHBOARD RENDER ---
        function updateDashboard() {
            let totalRealized = 0, totalOpen = 0, totalHeat = 0, totalExp = 0;
            let wins = 0, losses = 0;

            // 1. Calculate Balances
            const startBal = settings.startBalance;
            const adjustments = settings.adjustments || 0;
            
            // 2. Process Trades
            const rows = trades.map(t => {
                const calcs = calculatePL(t);
                const isClosed = t.status === 'Closed';
                
                if(isClosed) {
                    totalRealized += calcs.pl;
                    if(calcs.pl > 0) wins++; else losses++;
                } else {
                    totalOpen += calcs.pl;
                    totalHeat += calcs.heat;
                    totalExp += (t.entryPrice * t.qty);
                }

                // Time Held
                const d1 = new Date(t.date);
                const d2 = isClosed ? new Date(t.exitDate) : new Date();
                const days = Math.ceil((d2 - d1) / (1000 * 60 * 60 * 24));

                // Table Row
                return `
                <tr class="border-b border-gray-800 hover:bg-gray-800/50 text-xs transition">
                    <td class="p-3 font-bold text-blue-400">
                        ${t.symbol} 
                        <span class="text-[10px] ${t.direction === 'Short' ? 'text-red-400':'text-green-400'} block">${t.direction || 'Long'}</span>
                    </td>
                    <td class="p-3 hidden sm:table-cell text-gray-500">${t.date.substring(5,10)}</td>
                    <td class="p-3 font-mono">${t.entryPrice}</td>
                    <td class="p-3 font-mono text-gray-400">${t.stopLoss}</td>
                    <td class="p-3 font-mono ${isClosed ? 'text-gray-500' : 'text-white'}">
                        ${isClosed ? t.avgExitPrice : (t.livePrice||t.entryPrice).toFixed(2)}
                    </td>
                    <td class="p-3">${t.qty}</td>
                    <td class="p-3 hidden md:table-cell" id="weight-${t.id}">0%</td>
                    <td class="p-3 font-bold ${calcs.pl >= 0 ? 'text-green-500':'text-red-500'}">$${calcs.pl.toFixed(0)}</td>
                    <td class="p-3 ${calcs.plPct >= 0 ? 'text-green-500':'text-red-500'}">${calcs.plPct.toFixed(1)}%</td>
                    <td class="p-3 hidden lg:table-cell text-gray-400">$${calcs.heat.toFixed(0)}</td>
                    <td class="p-3 hidden lg:table-cell font-bold">${calcs.rr}</td>
                    <td class="p-3 hidden lg:table-cell">${days}d</td>
                    <td class="p-3 hidden lg:table-cell max-w-[100px] truncate" title="${t.notes}">${t.notes}</td>
                    <td class="p-3 flex gap-1">
                        ${!isClosed ? `<button onclick="openManage('${t.id}')" class="text-blue-400 p-1 hover:bg-gray-700 rounded"><i data-lucide="scissors" size="14"></i></button>` : ''}
                        <button onclick="openEdit('${t.id}')" class="text-gray-400 p-1 hover:bg-gray-700 rounded"><i data-lucide="edit-3" size="14"></i></button>
                        ${t.entryImage ? `<button onclick="showImage('${t.entryImage}')" class="text-orange-400 p-1 hover:bg-gray-700 rounded"><i data-lucide="image" size="14"></i></button>` : ''}
                        ${t.exitImage ? `<button onclick="showImage('${t.exitImage}')" class="text-purple-400 p-1 hover:bg-gray-700 rounded"><i data-lucide="flag" size="14"></i></button>` : ''}
                    </td>
                </tr>`;
            }).join('');

            document.getElementById('tradeTable').innerHTML = rows;

            // 3. Final Equity Calcs
            const equity = startBal + adjustments + totalRealized + totalOpen;
            const balance = startBal + adjustments + totalRealized;
            
            // Update Weights in Table (Now that we have Equity)
            trades.forEach(t => {
                const el = document.getElementById(`weight-${t.id}`);
                if(el && t.status === 'Open') {
                    const w = ((t.entryPrice * t.qty) / equity) * 100;
                    el.innerText = w.toFixed(1) + '%';
                    el.classList.add('text-orange-300');
                }
            });

            // Update Header Stats
            document.getElementById('dEquity').innerText = `$${equity.toLocaleString(undefined, {maximumFractionDigits:0})}`;
            document.getElementById('dBalance').innerText = `Cash: $${balance.toLocaleString(undefined, {maximumFractionDigits:0})}`;
            document.getElementById('dOpenPL').innerText = `$${totalOpen.toFixed(2)}`;
            document.getElementById('dOpenPL').className = totalOpen >= 0 ? 'text-green-400 font-bold' : 'text-red-400 font-bold';
            document.getElementById('dHeat').innerText = `$${totalHeat.toFixed(0)}`;
            document.getElementById('dExp').innerText = ((totalExp/equity)*100).toFixed(1) + '%';

            // Chart
            const ctx = document.getElementById('winLossChart').getContext('2d');
            if(winLossChart) winLossChart.destroy();
            winLossChart = new Chart(ctx, {
                type: 'doughnut',
                data: { labels: ['Win', 'Loss'], datasets: [{ data: [wins, losses], backgroundColor: ['#22c55e', '#ef4444'], borderWidth: 0 }] },
                options: { cutout: '75%', plugins: { legend: { display: false } } }
            });

            lucide.createIcons();
        }

        // --- UI HELPERS ---
        window.toggleModal = (id) => {
            const el = document.getElementById(id);
            el.classList.toggle('hidden');
            el.classList.toggle('flex');
        };

        window.openEdit = (id) => {
            document.getElementById('editTradeId').value = id || '';
            document.getElementById('modalTitle').innerText = id ? 'Edit Trade' : 'New Trade';
            
            if(id) {
                const t = trades.find(x=>x.id===id);
                document.getElementById('tSymbol').value = t.symbol;
                document.getElementById('tDirection').value = t.direction || 'Long';
                document.getElementById('tEntry').value = t.entryPrice;
                document.getElementById('tQty').value = t.qty;
                document.getElementById('tStop').value = t.stopLoss;
                document.getElementById('tNotes').value = t.notes || '';
            } else {
                ['tSymbol','tEntry','tQty','tStop','tNotes','tImage'].forEach(k=>document.getElementById(k).value='');
                document.getElementById('tDirection').value = 'Long';
            }
            toggleModal('tradeModal');
        };

        window.openManage = (id) => {
            document.getElementById('manageId').value = id;
            document.getElementById('exitImageFile').value = ''; // Reset file input
            toggleModal('partialModal');
        };

        window.openSettings = () => {
            document.getElementById('setStart').value = settings.startBalance;
            document.getElementById('totalAdjustments').innerText = settings.adjustments || 0;
            toggleModal('settingsModal');
        };

        window.showImage = (src) => {
            document.getElementById('lightboxImg').src = src;
            toggleModal('imageLightbox');
        };

        window.deleteTrade = async (id) => {
            if(confirm("Delete record?")) await deleteDoc(doc(db, "trades", id));
        };

        lucide.createIcons();
    </script>

    <style>
        body { background-color: #0f172a; color: #f8fafc; font-family: 'Inter', sans-serif; font-size: 14px; }
        .card { background: #1e293b; border: 1px solid #334155; border-radius: 0.75rem; padding: 1.25rem; }
        .input-field { background: #0f172a; border: 1px solid #334155; color: white; padding: 0.5rem; border-radius: 0.375rem; width: 100%; }
        /* Scrollbar for table */
        ::-webkit-scrollbar { height: 8px; width: 8px; }
        ::-webkit-scrollbar-track { background: #0f172a; }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 4px; }
    </style>
</head>
<body class="p-4 md:p-8 max-w-[1800px] mx-auto pb-20">

    <!-- HEADER -->
    <div class="flex flex-col md:flex-row justify-between items-center mb-6 gap-4">
        <h1 class="text-2xl font-bold flex items-center gap-2"><i data-lucide="bar-chart-2" class="text-blue-500"></i> TraderPro <span class="text-xs text-gray-500 bg-gray-800 px-2 py-1 rounded">v2.0</span></h1>
        <div class="flex gap-2 flex-wrap justify-center">
            <button onclick="openSettings()" class="bg-gray-800 hover:bg-gray-700 px-3 py-2 rounded text-gray-300 flex items-center gap-2 text-xs font-bold uppercase"><i data-lucide="wallet" size="14"></i> Wallet</button>
            <button id="refreshBtn" onclick="refreshPrices()" class="bg-gray-800 hover:bg-gray-700 px-3 py-2 rounded text-blue-400 flex items-center gap-2 text-xs font-bold uppercase"><i data-lucide="refresh-cw" size="14"></i> Live Prices</button>
            <button onclick="exportPDF()" class="bg-gray-800 hover:bg-gray-700 px-3 py-2 rounded text-gray-300 flex items-center gap-2 text-xs font-bold uppercase"><i data-lucide="download" size="14"></i> PDF</button>
            <button onclick="openEdit()" class="bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded text-white font-bold flex items-center gap-2 text-sm"><i data-lucide="plus" size="16"></i> New Trade</button>
        </div>
    </div>

    <!-- DASHBOARD STATS -->
    <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
        <div class="card space-y-1">
            <span class="text-gray-400 text-[10px] font-bold uppercase">Total Equity</span>
            <div id="dEquity" class="text-3xl font-bold">$0</div>
            <div id="dBalance" class="text-xs text-gray-500">Cash: $0</div>
        </div>
        <div class="card space-y-1">
            <span class="text-gray-400 text-[10px] font-bold uppercase">Open Profit/Loss</span>
            <div id="dOpenPL" class="text-2xl font-bold text-gray-500">$0.00</div>
        </div>
        <div class="card grid grid-cols-2 gap-4">
            <div>
                <span class="text-gray-400 text-[10px] font-bold uppercase">Open Heat</span>
                <div id="dHeat" class="text-xl font-bold text-red-400">$0</div>
            </div>
            <div>
                <span class="text-gray-400 text-[10px] font-bold uppercase">Exposure</span>
                <div id="dExp" class="text-xl font-bold text-orange-400">0%</div>
            </div>
        </div>
        <div class="card flex items-center justify-between">
            <div>
                <span class="text-gray-400 text-[10px] font-bold uppercase block mb-1">Win Rate</span>
                <div class="w-16 h-16"><canvas id="winLossChart"></canvas></div>
            </div>
        </div>
    </div>

    <!-- TABLE -->
    <div class="card !p-0 overflow-hidden">
        <div class="overflow-x-auto">
            <table class="w-full text-left border-collapse whitespace-nowrap">
                <thead class="bg-slate-800 text-gray-400 text-[10px] uppercase font-bold tracking-wider">
                    <tr>
                        <th class="p-3">Symbol</th>
                        <th class="p-3 hidden sm:table-cell">Date</th>
                        <th class="p-3">Entry</th>
                        <th class="p-3">Stop</th>
                        <th class="p-3">Last</th>
                        <th class="p-3">Qty</th>
                        <th class="p-3 hidden md:table-cell">Wgt %</th>
                        <th class="p-3">P/L $</th>
                        <th class="p-3">P/L %</th>
                        <th class="p-3 hidden lg:table-cell">Heat</th>
                        <th class="p-3 hidden lg:table-cell">R/R</th>
                        <th class="p-3 hidden lg:table-cell">Time</th>
                        <th class="p-3 hidden lg:table-cell">Notes</th>
                        <th class="p-3">Actions</th>
                    </tr>
                </thead>
                <tbody id="tradeTable"></tbody>
            </table>
        </div>
    </div>

    <!-- IMAGE LIGHTBOX -->
    <div id="imageLightbox" class="fixed inset-0 bg-black/95 hidden items-center justify-center z-[60] p-4 cursor-pointer" onclick="toggleModal('imageLightbox')">
        <img id="lightboxImg" src="" class="max-w-full max-h-[90vh] rounded shadow-2xl border border-gray-700">
    </div>

    <!-- TRADE MODAL (NEW/EDIT) -->
    <div id="tradeModal" class="fixed inset-0 bg-black/80 hidden items-center justify-center z-50 p-4">
        <div class="card w-full max-w-lg">
            <input type="hidden" id="editTradeId">
            <div class="flex justify-between items-center mb-4">
                <h2 id="modalTitle" class="font-bold text-lg">Trade Details</h2>
                <select id="tDirection" class="bg-gray-800 border border-gray-700 rounded px-2 py-1 text-xs">
                    <option value="Long">LONG ðŸŸ¢</option>
                    <option value="Short">SHORT ðŸ”´</option>
                </select>
            </div>
            
            <div class="grid grid-cols-2 gap-3 mb-3">
                <div><label class="text-[10px] text-gray-400 uppercase">Symbol</label><input id="tSymbol" class="input-field uppercase" type="text"></div>
                <div><label class="text-[10px] text-gray-400 uppercase">Quantity</label><input id="tQty" class="input-field" type="number"></div>
                <div><label class="text-[10px] text-gray-400 uppercase">Entry Price</label><input id="tEntry" class="input-field" type="number" step="0.01"></div>
                <div><label class="text-[10px] text-gray-400 uppercase">Stop Loss</label><input id="tStop" class="input-field" type="number" step="0.01"></div>
            </div>
            <div class="mb-3">
                <label class="text-[10px] text-gray-400 uppercase">Entry Chart</label>
                <input id="tImage" type="file" class="block w-full text-xs text-gray-400 mt-1 bg-gray-900 border border-gray-700 rounded p-1">
            </div>
            <div class="mb-4">
                <label class="text-[10px] text-gray-400 uppercase">Notes</label>
                <textarea id="tNotes" class="input-field h-20"></textarea>
            </div>
            <div class="flex gap-2">
                <button onclick="saveTrade()" class="flex-1 bg-blue-600 py-2 rounded font-bold">Save Record</button>
                <button onclick="toggleModal('tradeModal')" class="flex-1 bg-gray-700 py-2 rounded">Cancel</button>
            </div>
        </div>
    </div>

    <!-- PARTIAL/CLOSE MODAL -->
    <div id="partialModal" class="fixed inset-0 bg-black/80 hidden items-center justify-center z-50">
        <div class="card w-80">
            <input type="hidden" id="manageId">
            <h3 class="font-bold mb-4 text-center">Close Position</h3>
            
            <label class="text-[10px] text-gray-400 uppercase">Exit Price</label>
            <input type="number" id="exitPrice" class="input-field mb-2">
            
            <label class="text-[10px] text-gray-400 uppercase">Shares to Close</label>
            <input type="number" id="exitQty" class="input-field mb-3">

            <label class="text-[10px] text-gray-400 uppercase">Exit Chart (Optional)</label>
            <input type="file" id="exitImageFile" class="block w-full text-xs text-gray-400 mb-4 bg-gray-900 border border-gray-700 rounded p-1">

            <button onclick="executeClose(false)" class="w-full bg-blue-900/50 text-blue-300 py-2 rounded font-bold mb-2 hover:bg-blue-900">Partial Trim</button>
            <button onclick="executeClose(true)" class="w-full bg-red-600 text-white py-2 rounded font-bold mb-2 hover:bg-red-700">Full Close</button>
            <button onclick="toggleModal('partialModal')" class="w-full bg-gray-700 py-2 rounded mt-2">Cancel</button>
        </div>
    </div>

    <!-- SETTINGS MODAL -->
    <div id="settingsModal" class="fixed inset-0 bg-black/80 hidden items-center justify-center z-50 p-4">
        <div class="card w-full max-w-sm">
            <h2 class="font-bold text-lg mb-4">Wallet Settings</h2>
            
            <div class="mb-4">
                <label class="text-[10px] text-gray-400 uppercase">Initial Starting Balance</label>
                <input type="number" id="setStart" class="input-field">
            </div>

            <div class="grid grid-cols-2 gap-3 mb-4 p-3 bg-gray-900 rounded border border-gray-700">
                <div>
                    <label class="text-[10px] text-green-400 uppercase font-bold">Deposit (+)</label>
                    <input type="number" id="setDeposit" class="input-field" placeholder="$0">
                </div>
                <div>
                    <label class="text-[10px] text-red-400 uppercase font-bold">Withdraw (-)</label>
                    <input type="number" id="setWithdraw" class="input-field" placeholder="$0">
                </div>
                <div class="col-span-2 text-xs text-gray-500 text-center">
                    Current Net Adjustments: <span id="totalAdjustments" class="text-white font-mono">0</span>
                </div>
            </div>

            <div class="flex gap-2">
                <button onclick="saveSettings()" class="flex-1 bg-green-600 py-2 rounded font-bold">Update Wallet</button>
                <button onclick="toggleModal('settingsModal')" class="flex-1 bg-gray-700 py-2 rounded">Cancel</button>
            </div>
        </div>
    </div>

</body>
</html>
